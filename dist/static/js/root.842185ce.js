(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["root"],{"3d43":function(e,t,a){},"3e74":function(e,t,a){},4673:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"changePwd"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-setting"}),e._v(" 系统管理\n            ")]),a("el-breadcrumb-item",[e._v("首页")])],1)],1),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("div",{staticClass:"bill-top"},[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保存修改")]),a("el-button",{attrs:{loading:e.loading},on:{click:e.onTest}},[e._v("测试连接")]),a("el-button",{on:{click:e.onHelp}},[e._v("es常用配置")])],1),a("el-form",{ref:"form",staticClass:"handle-box-form",attrs:{model:e.form,"label-width":"85px",inline:"","label-position":"left"}},[a("el-form-item",{attrs:{label:"连接URL"}},[a("el-autocomplete",{staticClass:"handle-input mr10",attrs:{"fetch-suggestions":e.queryConnSearch,placeholder:"输入 ElasticSearch 服务器连接地址"},on:{select:e.handleConnSelect},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.item.conn))])]}}]),model:{value:e.form.connection,callback:function(t){e.$set(e.form,"connection",t)},expression:"form.connection"}})],1),a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{staticClass:"handle-input mr10",attrs:{maxlength:"200",placeholder:"输入 ElasticSearch 用户名"},model:{value:e.form.user,callback:function(t){e.$set(e.form,"user",t)},expression:"form.user"}})],1),a("el-form-item",{attrs:{label:"密码"}},[a("el-input",{staticClass:"handle-input mr10",attrs:{maxlength:"200",placeholder:"输入 ElasticSearch 密码","show-password":""},model:{value:e.form.pwd,callback:function(t){e.$set(e.form,"pwd",t)},expression:"form.pwd"}})],1),a("el-form-item",{attrs:{label:"集群名称"}},[a("el-input",{staticClass:"handle-input mr10 blue",attrs:{readonly:""},model:{value:e.form.connName,callback:function(t){e.$set(e.form,"connName",t)},expression:"form.connName"}})],1),a("el-form-item",{attrs:{label:"主节点"}},[a("el-input",{staticClass:"handle-input mr10 blue",attrs:{readonly:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"集群ID"}},[a("el-input",{staticClass:"handle-input mr10 blue",attrs:{readonly:""},model:{value:e.form.cluster_uuid,callback:function(t){e.$set(e.form,"cluster_uuid",t)},expression:"form.cluster_uuid"}})],1),a("el-form-item",{attrs:{label:"ES版本号"}},[a("el-input",{staticClass:"handle-input mr10 blue",attrs:{readonly:""},model:{value:e.form.versionNumber,callback:function(t){e.$set(e.form,"versionNumber",t)},expression:"form.versionNumber"}})],1)],1),a("div",{staticStyle:{display:"inline-flex"}},[a("h3",[a("span",{staticStyle:{"margin-right":"20px"}},[e._v("索引 ("+e._s(e.indexs.length)+")")])]),a("el-button",{staticClass:"handle-del mr10",attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.doRefresh}},[e._v("刷新")]),a("el-button",{staticClass:"handle-del mr10",attrs:{type:"text",icon:"el-icon-plus"},on:{click:e.doAddIndex}},[e._v("添加索引")])],1),a("el-row",{attrs:{gutter:12}},e._l(e.indexs,(function(t,i){return a("el-col",{key:i,attrs:{span:12}},[a("el-card",{staticClass:"box-card",attrs:{shadow:"hover"}},[a("div",{staticClass:"clearfix no-wrap nopadding",attrs:{slot:"header"},slot:"header"},[a("i",{staticClass:"el-icon-s-opportunity",style:"margin-right: 6px; padding: 2px; border-radius: 3px; background: #ccc; color:"+("green"==t.health?"#2da33e":t.health)}),a("span",[a("b",[e._v(e._s(t.index))])]),a("div",{staticStyle:{float:"right"}},[a("el-button",{staticStyle:{padding:"3px 3px","margin-left":"8px"},attrs:{type:"danger"},on:{click:function(a){return e.doDeleteIndex(t)}}},[e._v("删除")]),a("el-button",{staticStyle:{padding:"3px 3px","margin-left":"8px"},attrs:{type:"info"},on:{click:function(a){return e.doEditIndex(t)}}},[e._v("编辑")]),a("el-button",{staticStyle:{padding:"3px 3px","margin-left":"8px"},attrs:{type:"info"},on:{click:function(a){return e.doEditIndexAlias(t)}}},[e._v("别名")]),a("el-button",{staticStyle:{padding:"3px 3px","margin-left":"8px"},attrs:{type:"warning"},on:{click:function(a){return e.doEditIndexMappings(t)}}},[e._v("类型映射")]),a("el-button",{staticStyle:{padding:"3px 3px","margin-left":"8px"},attrs:{type:"info"},on:{click:function(a){return e.doViewIndex(t)}}},[e._v("查看数据")])],1)]),a("div",{staticClass:"text item"},[e._v("状态："),a("span",[e._v(e._s(t.status))])]),a("div",{staticClass:"text item no-wrap"},[e._v("描述："),a("span",{staticClass:"grey"},[e._v(e._s(e.getHealthDesc(t)))])]),a("div",{staticClass:"text item"},[e._v("分片数量："),a("span",[e._v(e._s(t.pri))])]),a("div",{staticClass:"text item"},[e._v("副本数量："),a("span",[e._v(e._s(t.rep))])]),a("div",{staticClass:"text item"},[e._v("文档数量："),a("span",[e._v(e._s(t["docs.count"]))])]),a("div",{staticClass:"text item"},[e._v("已删除文档数量："),a("span",[e._v(e._s(t["docs.deleted"]))])]),a("div",{staticClass:"text item"},[e._v("总存储空间："),a("span",[e._v(e._s(t["store.size"]))])]),a("div",{staticClass:"text item"},[e._v("索引存储空间："),a("span",[e._v(e._s(t["pri.store.size"]))])])])],1)})),1)],1)]),a("el-dialog",{attrs:{title:e.newform.edit?"编辑索引":"添加索引",visible:e.addIndexVisible,width:e.newform.edit?"450px":"65%"},on:{"update:visible":function(t){e.addIndexVisible=t}}},[a("el-form",{ref:"newform",attrs:{model:e.newform,"label-width":"85px"}},[a("el-form-item",{attrs:{label:"* 索引名称"}},[a("el-input",{attrs:{maxlength:"255",placeholder:"输入索引名称（不超过255个字符）",disabled:e.newform.edit,"show-word-limit":""},model:{value:e.newform.name,callback:function(t){e.$set(e.newform,"name",t)},expression:"newform.name"}}),e.newform.edit?e._e():a("ul",{staticStyle:{"margin-top":"12px","margin-left":"16px"}},[a("li",{staticClass:"hint-txt"},[e._v("索引受文件系统的限制。仅可能为小写字母，不能下划线开头")]),a("li",{staticClass:"hint-txt"},[e._v('不能包括 , /, *, ?, ", >, <, |, 空格, 逗号, #')]),a("li",{staticClass:"hint-txt"},[e._v("不能以这些字符 -, _, + 开头")]),a("li",{staticClass:"hint-txt"},[e._v("不能包括 . 或 …")])])],1),a("el-form-item",{attrs:{label:"* 分片数"}},[a("el-input",{attrs:{disabled:e.newform.edit},model:{value:e.newform.number_of_shards,callback:function(t){e.$set(e.newform,"number_of_shards",t)},expression:"newform.number_of_shards"}})],1),a("el-form-item",{attrs:{label:"* 副本数"}},[a("el-input",{model:{value:e.newform.number_of_replicas,callback:function(t){e.$set(e.newform,"number_of_replicas",t)},expression:"newform.number_of_replicas"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addIndexVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.doCreateIndex(e.newform.item)}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{visible:e.edtMappingsVisible,title:e.mappings.index+" - 字段映射 (mapping)",width:"75%","close-on-click-modal":!1},on:{"update:visible":function(t){e.edtMappingsVisible=t}}},[a("el-container",{staticStyle:{"max-height":"calc(100vh - 400px)"}},[a("el-main",[a("el-form",{ref:"mappings.mappings",attrs:{model:e.mappings.mappings,"label-width":"75px","label-position":"left"}},[a("el-form-item",{attrs:{label:"动态映射:"}},[a("mapping-class",{attrs:{mapClass:e.mappings.mappings}})],1),a("el-form-item",{attrs:{label:"属性:"}},[a("field",{attrs:{fieldData:e.mappings.mappings},on:{onAddChange:e.doAddMappingsField}})],1)],1),a("div",{staticStyle:{float:"left","margin-bottom":"6px","text-align":"left","font-size":"14px"}},[a("span",{staticClass:"grey"},[e._v("提示："),a("span",{staticClass:"red"},[e._v("建立映射后，字段名称和数据类型将无法修改！")]),a("br"),e._v("尽量选择范围小的类型，提高搜索效率.\n            "),a("br"),e._v("日期格式可以是：yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis")])])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.doSaveMappings(1)}}},[e._v("查看请求语句")]),a("el-button",{on:{click:function(t){e.edtMappingsVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.doSaveMappings()}}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{visible:e.edtAliasesVisible,title:e.alias.index+" - 别名管理 (aliases)",width:"50%"},on:{"update:visible":function(t){e.edtAliasesVisible=t}}},[a("el-form",{ref:"alias",attrs:{model:e.mappings.mappings,"label-width":"80px","label-position":"left"}},[e._l(e.alias.data,(function(t){return a("el-tag",{key:t,staticClass:"el-tag-mh",attrs:{closable:"",size:"medium","disable-transitions":!1},on:{close:function(a){return e.doDeleteAlias(t)}}},[e._v("\n                "+e._s(t.name)+"\n            ")])})),e.alias.inputVisible?a("el-input",{ref:"saveAliasInput",staticClass:"input-new-alias",attrs:{size:"small",placeholder:"新别名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.doAddAlias(t)}},model:{value:e.alias.inputValue,callback:function(t){e.$set(e.alias,"inputValue",t)},expression:"alias.inputValue"}}):a("el-button",{staticClass:"button-new-alias",attrs:{size:"small"},on:{click:e.showAliasInput}},[e._v("+ 新别名")])],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.edtAliasesVisible=!1}}},[e._v("完  成")])],1)],1)],1)},n=[],s=(a("ac6a"),a("7f7f"),a("cc46")),l=a("92e6"),o={name:"mainPage",components:{field:s["a"],mappingClass:l["a"]},data:function(){return{loading:!1,form:{connection:config.sServiceHost,user:config.sUser,pwd:config.sPwd,connName:void 0},his:[],newform:{},mappings:{mappings:{}},alias:{},indexs:[],dynamicTypes:[{name:"true (默认值，动态添加字段)",value:!0},{name:"false (忽略新字段)",value:!1},{name:"strict (陌生字段抛出异常)",value:"strict"}],addIndexVisible:!1,edtMappingsVisible:!1,edtAliasesVisible:!1}},mounted:function(){console.log("root mounted."),this.doRefresh()},methods:{queryConnSearch:function(e,t){var a=this.onLoadHisConn();t(a||[])},handleConnSelect:function(e){this.form.connection=e.conn,this.form.user=e.user,this.form.pwd=e.pwd,this.onSubmit(void 0,!1)},doRefresh:function(){var e=this;console.log("refresh"),this.check()&&(this.loading=!0,this.form.connName=void 0,this.$http.get("/").then((function(t){e.form.connName=t.cluster_name,e.form.name=t.name,e.form.cluster_uuid=t.cluster_uuid,e.form.versionNumber=t.version.number,config.cluster_name=t.cluster_name,config.name=t.name,e.loading=!1})).catch((function(){return e.loading=!1})),this.getIndexs())},doViewIndex:function(e){this.$router.push({path:"index",query:e})},showAliasInput:function(){var e=this;this.alias.inputVisible=!0,this.$forceUpdate(),this.$nextTick((function(t){e.$refs.saveAliasInput.$refs.input.focus()}))},doAddAlias:function(){var e=this;this.$http.post("/_aliases",null,{actions:[{add:{index:this.alias.index,alias:this.alias.inputValue}}]}).then((function(t){e.alias.data.push({name:e.alias.inputValue,value:{}}),e.alias.inputVisible=!1,e.alias.inputValue=void 0}))},doDeleteAlias:function(e){var t=this;this.$http.post("/_aliases",null,{actions:[{remove:{index:this.alias.index,alias:e.name}}]}).then((function(a){var i=t.alias.data.indexOf(e);i>=0&&t.alias.data.splice(i,1)}))},doAddIndex:function(){this.newform={number_of_shards:5,number_of_replicas:1},this.addIndexVisible=!0},doCreateIndex:function(e){var t=this;if(this.newform.edit)return this.newform.number_of_replicas?void this.$http.put("/"+this.newform.name+"/_settings",null,{number_of_replicas:this.newform.number_of_replicas}).then((function(a){1==a.acknowledged&&(e.rep=t.newform.number_of_replicas,t.addIndexVisible=!1)})):void this.$message.error("请输入副本数");this.check()&&(this.newform.name?this.newform.number_of_shards?this.newform.number_of_replicas?this.$http.put("/"+this.newform.name,null,{settings:{number_of_shards:this.newform.number_of_shards,number_of_replicas:this.newform.number_of_replicas}}).then((function(e){1==e.acknowledged&&(t.doRefresh(),t.addIndexVisible=!1)})):this.$message.error("请输入副本数"):this.$message.error("请输入分片数"):this.$message.error("请输入索引名称"))},doEditIndexMappings:function(e){var t=this;if(this.check()){var a=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});console.log("1"),this.mappings={item:e,index:e.index,mappings:{},src:void 0,newClass:{}},this.$http.get("/"+e.index+"/_mappings").then((function(i){t.mappings.src=i[e.index].mappings;var n=t.mappings.src,s={};s.dynamic=n.dynamic,s.items=[],console.log("2"),n.properties&&t.initProperties(s.items,0,n.properties),t.mappings.mappings=s,console.log("3"),a.close(),t.edtMappingsVisible=!0})).catch((function(){return a.close()}))}},initProperties:function(e,t,a){for(var i in a)if(i){var n=a[i];e.push({name:i,old:!0,id:this.uuid(),level:t,data:n}),n.properties&&this.initProperties(e,t+1,n.properties)}},doAddMappingsField:function(e,t,a){void 0!=e.items&&null!=e.items||(e.items=[]);var i={name:t.name,old:!1,id:this.uuid(),level:void 0==t.level?0:t.level,data:{}};void 0==a||a<0?e.items.push(i):e.items.splice(a,0,i)},getMapItemPath:function(e,t,a){if(0==a.level)return{properties:e,path:a.name};var i=this.mappings.mappings.items,n=a.level,s=t,l=[a.name];while(n>=0){var o=s;for(o;o>=0;o--)if(i[o].level<n){l.push(i[o].name);break}s=o,n--}for(var r=e,d="",c=l.length-1;c>0;c--)d=d+l[c]+".",r=r[l[c]].properties;return{properties:r,path:d+a.name}},doSaveMappings:function(e){var t=this,a={properties:{}},i=[],n=this.mappings.mappings;if(void 0!=n.dynamic&&(a.dynamic=n.dynamic),n.items)for(var s=0;s<n.items.length;s++){var l=n.items[s];if(void 0==l||!l.name||!l.data)return;var o=this.getMapItemPath(a.properties,s,l);if(i.indexOf(o.path)>=0)return void this.$message.error("属性名称【"+o.path+"】冲突");if(i.push(o.path),l.data.properties)o.properties[l.name]={dynamic:void 0,properties:{}},void 0!=l.data.dynamic&&""!=l.data.dynamic&&(o.properties[l.name].dynamic=l.data.dynamic);else{if(!l.data.type)return void this.$message.error("属性【"+o.path+"】未指定类型");var r={type:l.data.type};void 0!=l.data.null_value&&(r.null_value=l.data.null_value),void 0!=l.data.boost&&(r.boost=l.data.boost),void 0!=l.data.scaling_factor&&(r.scaling_factor=l.data.scaling_factor),void 0!=l.data.format&&(r.format=l.data.format),void 0!=l.data.index&&""!=l.data.index&&(r.index=l.data.index),void 0!=l.data.index_options&&(r.index_options=l.data.index_options),void 0!=l.data.doc_values&&(r.doc_values=l.data.doc_values),void 0!=l.data.ignore_above&&(r.ignore_above=l.data.ignore_above),void 0!=l.data.ignore_malformed&&(r.ignore_malformed=l.data.ignore_malformed),void 0!=l.data.coerce&&(r.coerce=l.data.coerce),void 0!=l.data.fields&&(r.fields=l.data.fields),o.properties[l.name]=r}}var d="/"+this.mappings.item.index+"/_mapping";if(1!=e){var c=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$http.put(d,null,a).then((function(e){c.close(),console.log(e),t.edtMappingsVisible=!1,t.$message.info("保存成功")})).catch((function(){return c.close()}))}else this.$alert('<el-container style="max-height: calc(100vh - 400px); "><el-main><span><b>请求地址: </b><br>POST '+d+'</span><br><br><pre style="height: 60vh; overflow: scroll;">'+JSON.stringify(a,null,2)+"</pre></el-main></el-container>","请求数据",{dangerouslyUseHTMLString:!0}).then((function(){}))},onLoadHisConn:function(){var e=[],t=localStorage.getItem("histConn");if(t)try{e=JSON.parse(t),Array.isArray(e)||(e=[])}catch(a){}return e},onSubmit:function(e,t){var a=this;if(this.check()){if(localStorage.setItem("conn",this.form.connection),localStorage.setItem("user",this.form.user),localStorage.setItem("pwd",this.form.pwd),void 0==t){var i,n=this.onLoadHisConn();n.forEach((function(e){e.conn==a.form.connection&&(i=e)})),i?(i.conn=this.form.connection,i.user=this.form.user,i.pwd=this.form.pwd):n.push({conn:this.form.connection,user:this.form.user,pwd:this.form.pwd}),localStorage.setItem("histConn",JSON.stringify(n))}config.sServiceHost=this.form.connection,config.sUser=this.form.user,config.sPwd=this.form.pwd,this.$http.updateBaseUrl(),this.doRefresh()}},onTest:function(){var e=this;this.check()&&(this.loading=!0,this.form.connName=void 0,this.$http.getEx(this.form.connection).then((function(t){e.loading=!1,e.form.connName=t.cluster_name,e.form.name=t.name,e.form.cluster_uuid=t.cluster_uuid,config.cluster_name=t.cluster_name,config.name=t.name})).catch((function(){return e.loading=!1})))},onHelp:function(){var e='http.cors.enabled: true\nhttp.cors.allow-origin: "*"\n# 集群名称\ncluster.name: test\n# 节点名称 (指挥官)\nnode.name: master\n# 设定自己为master\nnode.master: true\n# 绑定的ip地址\nnetwork.host: 127.0.0.1\n# 用户密码\nhttp.cors.allow-headers: Authorization, content-type\nxpack.security.enabled: true\nxpack.security.transport.ssl.enabled: true\n\n';this.$alert('<el-container style="max-height: calc(100vh - 400px); "><el-main><pre style="height: 60vh; overflow: scroll;">'+e+"</pre></el-main></el-container>","请求数据",{dangerouslyUseHTMLString:!0}).then((function(){}))},check:function(){return!!this.form.connection||(this.$message.error("请输入 ElasticSearch 服务器连接地址"),!1)},getIndexs:function(){if(this.check()){this.indexs=[];var e=this;this.$http.get("/_cat/indices?format=json").then((function(t){e.indexs=void 0==t?[]:t}))}},getHealthDesc:function(e){return"yellow"==e.health?"[可用] 所有数据是可以获取的，但是一些复制品还没有被分配(集群功能齐全)":"green"==e.health?"[良好] 一切运行正常(集群功能齐全)":"red"==e.health?"[异常] 数据缺失(集群部分功能不可用)":""},doDeleteIndex:function(e){var t=this;this.$confirm("删除索引【<b>".concat(e.index,"</b>】,")+"是否确定？","删除索引",{type:"warning",dangerouslyUseHTMLString:!0}).then((function(){t.$http.delete("/"+e.index+"?pretty").then((function(e){t.doRefresh()}))})).catch((function(){}))},doEditIndex:function(e){this.newform={name:e.index,edit:!0,item:e,number_of_shards:e.pri,number_of_replicas:e.rep},this.addIndexVisible=!0},doEditIndexAlias:function(e){var t=this;if(this.check()){var a=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.alias={item:e,index:e.index,data:[]},this.$http.get("/"+e.index+"/_alias").then((function(i){a.close();var n=i[e.index].aliases;for(var s in n)t.alias.data.push({name:s,value:n[s]});t.edtAliasesVisible=!0})).catch((function(){return a.close()}))}}}},r=o,d=(a("8d76"),a("c876"),a("2877")),c=Object(d["a"])(r,i,n,!1,null,"883d99fa",null);t["default"]=c.exports},5984:function(e,t,a){},"5ebb":function(e,t,a){"use strict";var i=a("86f9"),n=a.n(i);n.a},"86f9":function(e,t,a){},"8d76":function(e,t,a){"use strict";var i=a("3e74"),n=a.n(i);n.a},"8e6f":function(e,t,a){"use strict";var i=a("3d43"),n=a.n(i);n.a},"92e6":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",{staticClass:"w3 wp mr10",attrs:{clearable:"",placeholder:e.placeholder},model:{value:e.cls.dynamic,callback:function(t){e.$set(e.cls,"dynamic",t)},expression:"cls.dynamic"}},e._l(e.dynamicTypes,(function(t,i){return a("el-option",{key:i,attrs:{label:""+t.value,value:t.value}},[a("span",[e._v(e._s(t.name))])])})),1)},n=[],s={name:"mappingClass",data:function(){return{cls:{},dynamicTypes:[{name:"true (默认值，动态添加字段)",value:!0},{name:"false (忽略新字段)",value:!1},{name:"strict (陌生字段抛出异常)",value:"strict"}]}},props:{mapClass:{type:Object,required:!0},placeholder:{type:String,default:"点击选择"}},created:function(){},mounted:function(){this.cls=this.mapClass,"true"==this.cls.dynamic?this.cls.dynamic=!0:"false"==this.cls.dynamic&&(this.cls.dynamic=!1)},computed:{},methods:{}},l=s,o=(a("8e6f"),a("2877")),r=Object(o["a"])(l,i,n,!1,null,"13b17fe0",null);t["a"]=r.exports},"9a38":function(e,t,a){"use strict";var i=a("5984"),n=a.n(i);n.a},a133:function(e,t,a){},c876:function(e,t,a){"use strict";var i=a("a133"),n=a.n(i);n.a},cc46:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[void 0!=e.fieldData.items&&e.fieldData.items.length>0?a("div",e._l(e.fieldData.items,(function(t,i){return a("div",{key:t.id},[a("field-item",{style:"margin-left:"+24*t.level+"px;",attrs:{field:t},on:{onDelete:e.doDeleteItem,onAddChild:e.doAddChildItem,onShowCode:e.doShowFieldCode}})],1)})),0):e._e(),a("el-button",{attrs:{icon:"el-icon-plus"},on:{click:function(t){return e.doAddField()}}},[e._v("添加")]),a("el-dialog",{attrs:{visible:e.edtFieldCodeVisible,title:"属性  "+e.curField.name,width:"75%","append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.edtFieldCodeVisible=t}}},[a("el-input",{attrs:{readonly:e.curField.old,type:"textarea",rows:20,placeholder:"请输入内容"},model:{value:e.curFieldCode,callback:function(t){e.curFieldCode=t},expression:"curFieldCode"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.edtFieldCodeVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{disabled:e.curField.old},on:{click:function(t){return e.doSaveFieldCode()}}},[e._v("确 定")])],1)],1)],1)},n=[],s=(a("7f7f"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"field-item",staticStyle:{"margin-bottom":"4px"}},[a("el-input",{staticClass:"w1 mr10 wp",attrs:{placeholder:"属性名称",disabled:e.field.old},model:{value:e.fieldData.name,callback:function(t){e.$set(e.fieldData,"name",t)},expression:"fieldData.name"}}),a("el-select",{staticClass:"w4 wp mr10",attrs:{clearable:"",disabled:e.field.old||void 0!=e.fieldData.data.properties,placeholder:"属性类型"},on:{change:e.onDataTypeChange},model:{value:e.fieldData.data.type,callback:function(t){e.$set(e.fieldData.data,"type",t)},expression:"fieldData.data.type"}},e._l(e.fieldTypes,(function(t,i){return a("el-option",{key:"_opt_"+i,attrs:{label:""+t.value,value:t.value}},[a("span",[e._v(e._s(t.value))]),a("span",{staticClass:"select-desc"},[e._v(e._s(t.name))])])})),1),e.fieldData.data.properties?a("mapping-class",{attrs:{mapClass:e.fieldData.data}}):e._e(),e.fieldData.data.properties||"string"==e.fieldData.data.type||"text"==e.fieldData.data.type?e._e():a("el-input",{staticClass:"w2 mr10 wp",attrs:{placeholder:"默认值"},on:{input:e.setNullValue},model:{value:e.null_value,callback:function(t){e.null_value=t},expression:"null_value"}}),e.fieldData.data.properties?e._e():a("el-input",{staticClass:"w5 mr10 wp",attrs:{placeholder:"加权",title:"字段级别索引分数加权，浮点数值，默认1.0"},model:{value:e.fieldData.data.boost,callback:function(t){e.$set(e.fieldData.data,"boost",t)},expression:"fieldData.data.boost"}}),e.fieldData.data.properties||"scaled_float"!=e.fieldData.data.type?e._e():a("el-input",{staticClass:"w2 mr10 wp",attrs:{placeholder:"比例因子"},model:{value:e.fieldData.data.scaling_factor,callback:function(t){e.$set(e.fieldData.data,"scaling_factor",t)},expression:"fieldData.data.scaling_factor"}}),e.fieldData.data.properties||"date"!=e.fieldData.data.type?e._e():a("el-input",{staticClass:"w3 mr10 wp",attrs:{placeholder:"格式"},model:{value:e.fieldData.data.format,callback:function(t){e.$set(e.fieldData.data,"format",t)},expression:"fieldData.data.format"}}),e.fieldData.data.properties?e._e():a("el-select",{staticClass:"w3 wp mr10",attrs:{clearable:"",title:"默认 not_analyzed",placeholder:"索引状态"},on:{change:e.onIndexTypeChange},model:{value:e.fieldData.data.index,callback:function(t){e.$set(e.fieldData.data,"index",t)},expression:"fieldData.data.index"}},e._l(e.indexStatus,(function(t,i){return a("el-option",{key:"_opt_"+i,attrs:{label:""+t.value,value:t.value}},[a("span",[e._v(e._s(t.value))]),a("span",{staticClass:"select-desc"},[e._v(e._s(t.name))])])})),1),e.fieldData.data.properties||"string"!=e.fieldData.data.type&&"text"!=e.fieldData.data.type&&"keyword"!=e.fieldData.data.type?e._e():a("el-select",{staticClass:"w3 wp mr10",attrs:{clearable:"",title:void 0==e.fieldData.data.index||e.fieldData.data.index?"默认 positions":"默认 docs",placeholder:"索引选项"},model:{value:e.fieldData.data.index_options,callback:function(t){e.$set(e.fieldData.data,"index_options",t)},expression:"fieldData.data.index_options"}},e._l(e.indexOptions,(function(t,i){return a("el-option",{key:"_opt_"+i,attrs:{label:""+t.value,value:t.value}},[a("span",[e._v(e._s(t.value))]),a("span",{staticClass:"select-desc"},[e._v(e._s(t.name))])])})),1),e.fieldData.data.properties?e._e():a("el-checkbox",{staticClass:"mr8",attrs:{label:"排序聚合",title:"支持排序和聚合",checked:void 0==e.fieldData.data.doc_values||e.fieldData.data.doc_values},model:{value:e.fieldData.data.doc_values,callback:function(t){e.$set(e.fieldData.data,"doc_values",t)},expression:"fieldData.data.doc_values"}}),a("el-button",{attrs:{icon:"el-icon-setting",size:"mini",type:"text",title:"查看或编辑代码"},on:{click:function(t){return e.doViewCode()}}}),e.field.old?e._e():a("el-button",{attrs:{icon:"el-icon-close",size:"mini",type:"text",title:"删除属性"},on:{click:function(t){return e.doDeleteField()}}}),!e.field.old||e.fieldData.data.properties?a("el-button",{attrs:{icon:"el-icon-plus",size:"mini",type:"text",title:"添加子属性"},on:{click:function(t){return e.doAddField()}}}):e._e()],1)}),l=[],o=a("92e6"),r={name:"fieldItem",components:{mappingClass:o["a"]},data:function(){return{null_value:void 0,fieldData:{data:{}},fieldTypes:[{name:"字符串（需要全文检索时使用）",value:"text"},{name:"字符串（精确值搜索）",value:"keyword"},{name:"布尔值（true 或 false）",value:"boolean"},{name:"整数（32位有符号）",value:"integer"},{name:"整数（64位有符号）",value:"long"},{name:"整数（-32768~32767）",value:"short"},{name:"整数（-128~127）",value:"byte"},{name:"浮点数（64位）",value:"double"},{name:"浮点数（32位）",value:"float"},{name:"浮点数（16位）",value:"half_float"},{name:"浮点数（缩放类型）",value:"scaled_float"},{name:"日期类型",value:"date"},{name:"范围类型",value:"range"},{name:"二进制数据（默认只存储不索引）",value:"binary"},{name:"JSON对象",value:"object"},{name:"嵌套类",value:"nested"},{name:"地理坐标",value:"geo_point"},{name:"地理地图",value:"geo_shape"},{name:"IPv4或IPv6地址",value:"ip"},{name:"范围类型",value:"completion"},{name:"附件类型",value:"attachment"},{name:"抽取类型",value:"percolator"}],indexStatus:[{name:"无索引，不可查询",value:!1},{name:"有索引（默认）",value:!0}],indexOptions:[{name:"索引文档号",value:"docs"},{name:"文档号+词频",value:"freqs"},{name:"文档号+词频+位置，通常用来距离查询",value:"positions"},{name:"文档号+词频+位置+偏移量，通常被使用在高亮字段",value:"offsets"}]}},props:{field:{type:Object,required:!0}},created:function(){},computed:{},mounted:function(){this.fieldData=this.field,this.null_value=this.getNullValue()},methods:{doDeleteField:function(){this.$emit("onDelete",this.field)},doAddField:function(){this.$emit("onAddChild",this.field),this.$forceUpdate()},doViewCode:function(){this.$emit("onShowCode",this.field)},onDataTypeChange:function(e){this.setNullValue(this.null_value,e),this.null_value=this.getNullValue()},onIndexTypeChange:function(e){this.index=void 0==e||""==e?void 0:"true"===e},getNullValue:function(){var e=this.fieldData.data.null_value;return void 0!=e&&(e+=""),e},setNullValue:function(e,t){var a;if(void 0!=e&&""!==e){var i=void 0==t?this.fieldData.data.type:t;if("integer"==i||"long"==i||"short"==i||"byte"==i)a=parseInt(e),isNaN(a)&&(a=void 0);else if("double"==i||"float"==i||"half_float"==i||"scaled_float"==i)a=parseFloat(e),isNaN(a)&&(a=void 0);else if("boolean"==i)a="true"==e||"yes"==e||!0===e;else if("object"==i||"array"==i)if(e)try{a=JSON.parse(e)}catch(n){a=void 0}else a=void 0;else a=e}this.fieldData.data.null_value=a}}},d=r,c=(a("5ebb"),a("2877")),u=Object(c["a"])(d,s,l,!1,null,"01d9fc27",null),f=u.exports,p={name:"field",components:{fieldItem:f},data:function(){return{cls:{data:{},name:void 0},curField:{},edtFieldCodeVisible:!1,curFieldCode:void 0}},props:{fieldData:{type:Object,required:!0}},created:function(){},computed:{},mounted:function(){},methods:{doShowFieldCode:function(e){this.curField=e,this.curFieldCode=JSON.stringify(e.data,null,2),this.edtFieldCodeVisible=!0},doSaveFieldCode:function(){try{var e=JSON.parse(this.curFieldCode);void 0==e&&(e={}),this.curField.data=e,this.curField={},this.edtFieldCodeVisible=!1}catch(t){this.$message.error("代码错误："+t)}},doAddField:function(){this.$emit("onAddChange",this.fieldData,{name:this.cls.name,type:this.cls.data.type,format:this.cls.data.format,scaled_float:this.cls.data.scaled_float,index:this.cls.data.index,enabled:!0}),this.cls.name=void 0,this.$forceUpdate()},doDeleteItem:function(e){var t=this.getParentItem(e);if(!(t.index<0)){console.log(t),t.count<=1&&t.parent&&(t.parent.data={});for(var a=1,i=t.index+1;i<this.fieldData.items.length;i++){var n=this.fieldData.items[i];if(!(n.level>e.level))break;a++}this.fieldData.items.splice(t.index,a),this.$forceUpdate()}},doAddChildItem:function(e){var t=this.fieldData.items.indexOf(e);if(!(t<0)){e.data={properties:{}};var a=this.getNextItemIndex(t);this.$emit("onAddChange",this.fieldData,{name:void 0,type:void 0,level:e.level+1,enabled:!0},a<0?t+1:a),this.$forceUpdate()}},getNextItemIndex:function(e){for(var t=this.fieldData.items[e].level,a=e+1;a<this.fieldData.items.length;a++)if(this.fieldData.items[a].level==t)return a;return-1},getParentItem:function(e){for(var t,a=this.fieldData.items,i=0,n=-1,s=-1,l=0;l<a.length;l++)if(a[l]==e){if(s=l,0==e.level)n=0;else for(var o=l;o>=0;o--)if(a[o].level<e.level){t=a[o],n=o;break}break}for(var r=n+1;r<a.length;r++){var d=a[r].level;if(d==e.level)i++;else if(d<e.level)break}return{count:i,parent:t,index:s}}}},m=p,h=(a("9a38"),Object(c["a"])(m,i,n,!1,null,"736bbd03",null));t["a"]=h.exports}}]);